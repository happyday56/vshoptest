<hi:common_header runat="server" />

<div id="dialogMobile">
    <input id="mobile" type="text" />
    <br />
    <input id="code" type="text" /><input type="button" value="发送" id="sendCode" /><br />
    <br />
    <input type="button" value="绑定" id="bingdMobile" />
   <input type="text" id="returnUrl" runat="server" style="display:none" />
</div>
<hi:common_footer runat="server" />

<script>
    
    $(function () {
        
        $("#sendCode").click(function () {
            var mobile = $("#mobile").val();
            var url = '/API/VshopProcess.ashx';
            $.ajax({
                type: "get",
                url: url,
                data: { action: 'SendBindMobileVerifyCode', mobile: mobile },
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data.success) {
                        alert("成功");
                    }
                    else {
                        alert("发送失败");
                    }
                }
            });
        });


        $("#bingdMobile").click(function () {
            var mobile = $("#mobile").val();
            var code = $("#code").val();
            var url = '/API/VshopProcess.ashx';
            $.ajax({
                type: "get",
                url: url,
                data: { action: 'BindMobile', mobile: mobile, code: code },
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data.success) {
                        alert("成功");
                        window.location.href = $("#vBindMobile_returnUrl").val();
                    }
                    else {
                        alert(data.msg);
                    }
                }
            });
        });

        
    })

</script>
